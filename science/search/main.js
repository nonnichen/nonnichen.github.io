var sugfrom="haosou";function srchsug(){var searchword=$("#srhkey").val();if(searchword==null||searchword==""){$("#auto").empty();$("#auto").hide();return}window.status="请求中";var datas;if(sugfrom=="baidu"){datas={"wd":searchword,"p":"3","cb":"ShowDiv",};sugurl="http://unionsug.baidu.com/su"}else{if(sugfrom=="haosou"){datas={"callback":"ShowDiv","encodein":"utf-8","encodeout":"utf-8","format":"json","word":searchword};sugurl="https://sug.so.360.cn/suggest"}else{if(sugfrom=="bing"){datas={"type":"cb","q":searchword,"cb":"ShowDiv"};sugurl="https://api.bing.com/qsonhs.aspx"}else{if(sugfrom=="sogou"){datas={"type":"news","key":searchword,"cb":"ShowDiv",};sugurl="https://www.sogou.com/suggnew/ajajjson"}}}}$.ajax({async:false,url:sugurl,type:"GET",dataType:"jsonp",jsonp:"jsoncallback",data:datas,success:function(json){},error:function(xhr){}})}function ShowDiv(data){Info=new Array();if(sugfrom=="baidu"){Info=data.s}else{if(sugfrom=="haosou"){datas=data.result;for(var i=0;i<datas.length;i+=1){Info[i]=datas[i].word}}else{if(sugfrom=="bing"){datas=data.AS.Results[0].Suggests;for(var i=0;i<datas.length;i+=1){Info[i]=datas[i].Txt}}else{if(sugfrom=="sogou"){datas=data[1];for(var i=0;i<datas.length;i+=1){Info[i]=datas[i]}}}}}autoDisplay(Info);window.status="请求结束"}function autoDisplay(Info){var wordText=$("#srhkey").val();var autoNode=$("#auto");var autowidth=$("#srhkey").get(0).offsetWidth;autoNode.width(autowidth);if(Info.length==0){autoNode.hide();return false}autoNode.empty();nmax=5;for(var i=0;i<nmax;i++){var wordNode=Info[i];var newDivNode=$("<div>").attr("id",i);newDivNode.attr("style","font-size:16px;line-height:20px;padding:2px 8px;color:#222;cursor:pointer;overflow:ellipsis");newDivNode.html(wordNode).appendTo(autoNode);newDivNode.mouseover(function(){if(highlightindex!=-1){autoNode.children("div").eq(highlightindex).css("background-color","white")}highlightindex=$(this).attr("id");$(this).css("background-color","#ebebeb")});newDivNode.mouseout(function(){$(this).css("background-color","white")});newDivNode.click(function(){var comText=autoNode.hide().children("div").eq(highlightindex).text();highlightindex=-1;$("#srhkey").val(comText)});if(Info.length>0){autoNode.show()}else{autoNode.hide();highlightindex=-1}}}var timeoutId;var highlightindex=-1;$(function(){$("#srhkey").keyup(function(event){var myEvent=event||window.event;var keyCode=myEvent.keyCode;if(keyCode>=65&&keyCode<=90||keyCode>=48&&keyCode<=57||keyCode>=96&&keyCode<=111||keyCode>=186&&keyCode<=222||keyCode==8||keyCode==46||keyCode==32){srchsug();if(highlightindex!=-1){highlightindex=-1}}else{if(keyCode==38||keyCode==40){if(keyCode==38){var autoNodes=$("#auto").children("div");if(highlightindex!=-1){autoNodes.eq(highlightindex).css("background-color","white");highlightindex--}else{highlightindex=autoNodes.length-1}if(highlightindex==-1){highlightindex=autoNodes.length-1}autoNodes.eq(highlightindex).css("background-color","#ebebeb");var comText=autoNodes.eq(highlightindex).text();$("#srhkey").val(comText)}if(keyCode==40){var autoNodes=$("#auto").children("div");if(highlightindex!=-1){autoNodes.eq(highlightindex).css("background-color","white")}highlightindex++;if(highlightindex==autoNodes.length){highlightindex=0}autoNodes.eq(highlightindex).css("background-color","#ebebeb");var comText=autoNodes.eq(highlightindex).text();$("#srhkey").val(comText)}}else{if(keyCode==27){if($("#auto").is(":visible")){$("#auto").hide()}}}}});document.onclick=function(e){var e=e?e:window.event;var tar=e.srcElement||e.target;if(tar.id!="srhkey"){if($("#auto").is(":visible")){$("#auto").css("display","none")}}}});Msg="请输入关键词...";$("#srhkey").click(function(){if($("#srhkey").val()==Msg){$("#srhkey").val("")}});var t=$("#srhkey").val();$("#srhkey").val("").focus().val(t);$("button[id^='srhbt']").click(function(){var action=$(this).attr("action");keystr=$("#srhkey").val();openTag(action,keystr)});$(document).keydown(function(event){if(event.keyCode==13){action=$("button[id^='srhbt']").first().attr("action");keystr=$("#srhkey").val();openTag(action,keystr)}});function openTag(action,s){s=ckey(s);if(s==false){$("#srhkey").val(Msg);$("#srhkey").focus().select();return false}url=action+s;var newTab=window.open("about:blank");newTab.location.href=url}function ckey(s){if(s.replace(/(^\s*)|(\s*$)/g,"").length==0||s==Msg){return false}s=encodeURI(s);s=s.replace("&","%26");return s}$("#type a").click(function(){var tmp=$(this).attr("href");var s=ckey($("#srhkey").val());if(s!==false){$(this).attr("href",tmp+"?q="+s)}return});function testG(url){var st=url.indexOf("//",0);var _domain=url.substring(st+1,url.length);var et=_domain.indexOf("/",1);surl=url.substring(0,et+st+2);document.write('<img src="'+surl+'favicon.ico" onerror="fai(this)" onload="suc(\''+url+"')\" />")}function suc(url){$("#srhbt1").attr("action",url);$("#srhbt1").html(gtxt)}function fai(obj){return};